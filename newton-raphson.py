# -*- coding: utf-8 -*-"""Created on Sun Jan 24 20:13:04 2016@author: admin-bellei""""""Created on Sat Jan 23 19:38:54 2016@author: admin-bellei"""import pickleimport numpy as npimport matplotlib.pylab as pltfrom sys import exitfrom TDMAsolver import TDMAsolverfrom pandas import DataFrameimport csvLDIAG = list( csv.reader(open('LDIAG.csv')) )LDIAG = np.asarray(LDIAG).astype(float)DIAG = list( csv.reader(open('DIAG.csv')) )DIAG = np.asarray(DIAG).astype(float)UDIAG = list( csv.reader(open('UDIAG.csv')) )UDIAG = np.asarray(UDIAG).astype(float)BB = list( csv.reader(open('BB.csv')) )BB = np.asarray(BB).astype(float)T = list( csv.reader(open('T.csv')) )T = np.asarray(T).astype(float).ravel()#TT = list( csv.reader(open('Tnew.csv')) )#TT = np.asarray(TT).astype(float).ravel()Tnew = np.copy(T)#example that works!!!#---------------------#LDIAG = np.array([0.1,0.1,0.1,0.1])#DIAG = np.array([1.,1.,1.,1.,1.])#UDIAG = np.array([0.1,0.1,0.1,0.1])#BB = np.array([0.1,0.1,0.1,0.1,0.1])#LPACK test that is wrong!!!#---------------------#LDIAG = np.array([3.4,3.6,7.0,-6.0])#DIAG  = np.array([3.0,2.3,-5.0,-0.9,7.1])#UDIAG = np.array([2.1,-1.0,1.9,8.0])#BB  = np.array([2.7,-0.5,2.6,0.6,2.7])#my example that doesn't work!!!#----------------------------#LDIAG = np.array([0.1,0.1,0.1,0.1])#DIAG = np.array([0.01,0.01,0.01,0.01,0.01])#UDIAG = np.array([0.1,0.1,0.1,0.1])#BB = np.array([0.1,0.1,0.1,0.1,0.1])A = np.zeros((len(DIAG),len(DIAG)))for i in range(len(DIAG)):    A[i,i] = DIAG[i]    if(i>0):        A[i,i-1] = LDIAG[i-1]    if(i<len(DIAG)-1):        A[i,i+1] = UDIAG[i-1]X1 = np.dot(np.linalg.inv(A),BB)Tnew[1:-1] = Tnew[1:-1] - X1.ravel()plt.plot(T)plt.plot(Tnew)plt.figure()plt.plot((T-Tnew)/qe_C)#X2 = TDMAsolver(LDIAG,DIAG,UDIAG,BB)#print DataFrame(A)#print np.transpose(X1)#print X2